<style>
	
	.person {
		text-align: center;
		line-height: 150px;
		width: 100px;
		height: 150px;
		border: 1px solid red;
		position: absolute;
	}
	
	.proxy {
		line-height: 0;
		width: 0;
		height: 0;
		position: absolute;
		border: 5px solid red;
	}
	
</style>

<div id="canvas">
	
	<div
		id="uid1"
		class="person"
		style="top:100px;left:100px;"
	>
		M
	</div>
	
	<!-- <div id="uid1-2" class="proxy" has-children="uid3,uid4,uid5" style="top:175px;left:248px;"></div> -->
	
	<div
		id="uid2"
		class="person"
		style="top:100px;left:300px;"
	>
		F
	</div>
	
	<div
		id="uid3"
		class="person"
		mother="uid1"
		father="uid2"
		style="top:400px;left:200px;"
	>
		F
	</div>
	
	<div
		id="uid4"
		class="person"
		mother="uid1"
		father="uid2"
		style="top:400px;left:400px;"
	>
		F
	</div>
	
	<div
		id="uid5"
		class="person"
		mother="uid1"
		father="uid2"
		style="top:400px;left:600px;"
	>
		F
	</div>
	
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jsPlumb/2.0.7/jsPlumb.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script>
	$(function() {
		
		function draw() {
			
			var parents = {
				connector: 'Straight',
				anchor: 'AutoDefault'
			};
			var children = {};
			var attrs = ['has-children', 'has-spouse'];
			
			jsPlumb.batch(function() {
				$.each(attrs, function(index1, value1) {
					$('[' + value1 + ']').each(function() {
						var $this = $(this);
						var source = $this.attr('id');
						var target = $this.attr(value1).split(',');
						//var parent = ((target.length > 1) ? true : false);
						$.each(target, function(index2, value2) {
							jsPlumb.connect({
								source: source,
								target: value2,
								isSource: true, // ?
								isTarget: true, // ?
								//maxConnections: (parent ? -1 : 1),
								maxConnections: -1
							}, (value1 == 'has-spouse' ? parents : children));
						})
					});
				});
			});
			
		}
		
		function init() {
			
			// https://jsplumbtoolkit.com/community/doc/connect-examples.html
			jsPlumb.ready(function() {
				
				jsPlumb.importDefaults({
					ConnectionsDetachable: false,
					Connector: ['Flowchart', {
						// stub: [
						// 	50,
						// 	50
						// ],
						gap: 0,
						cornerRadius: 0,
						alwaysRespectStubs: true
					}],
					Anchors:[
						'Bottom',
						'Top'
					],
					Endpoint: ['Dot', {
						radius: 5
					}],
					EndpointStyles: [{
						fillStyle: 'gray'
					}, {
						fillStyle: 'gray'
					}],
					PaintStyle: {
						strokeStyle: 'gray',
						fillStyle: 'gray',
						radius: 0,
						lineWidth: 3
					},
				});
				
				jsPlumb.setContainer($('#canvas'));
				
				draw();
				
			});
			
		}
		
		function getMidPoint($el1, $el2) {
			
			var meta = function($obj) {
				
				return {
					offset: $obj.offset(),
					width: $obj.width(),
					height: $obj.height()
				};
				
			};
			
			var meta1 = meta($el1);
			var meta2 = meta($el2);
			
			return {
				top: (
					(
						(meta1.offset.top + (meta1.height / 2))
						+
						(meta2.offset.top + (meta2.height / 2))
					) / 2
				),
				left: (
					(
						(meta1.offset.left + (meta1.width / 2))
						+
						(meta2.offset.left + (meta2.width / 2))
					) / 2
				)
			};
			
		}
		
		function go() {
			
			var found = [];
			
			$('[mother][father]').each(function(key, value) {
				
				var $proxy;
				var mother = $(value).attr('mother');
				var father = $(value).attr('father');
				var position;
				
				if ($.inArray((mother + father), found)) {
					
					$proxy = $('<div />', {
						'class': 'proxy'
					});
					
					position = getMidPoint($('#' + mother), $('#' + father));
					
					$proxy.css({
						'top': position.top,
						'left': position.left
					});
					
					$('#canvas').append($proxy);
					
				}
				
				found.push(mother + father);
				
			});
			
		}
		
		go();
		
		//init();
		
	});
</script>
